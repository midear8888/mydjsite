{% extends 'users/base_a.html' %}

{% block title %}Usercenter{%  endblock %}

{% block css %}
    <link rel="stylesheet" href="{% static 'users/css/smoothbox.css' %}" type='text/css' media="all" />
{% endblock %}

{% block nav %}
    <li class="nav-item  mr-lg-3">
        <a class="nav-link" href="{% url 'home' %}">Home
            <span class="sr-only">(current)</span>
        </a>
    </li>
    <li class="nav-item dropdown active mr-lg-3">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
									Data
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="{% url 'history' %}">Historys</a>
            <a class="dropdown-item" href="{% url 'gallery' %}">Gallery</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="{% url 'home' %}">Analysis</a>
        </div>
    </li>
    <li class="nav-item dropdown mr-lg-3">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
									Help
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="{% url 'about' %}">About</a>
            <a class="dropdown-item" href="{% url 'contact' %}">Contact</a>
            <a class="dropdown-item" href="{% url 'service' %}">Service</a>
        </div>
    </li>
    <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="fas fa-user"></i>&nbsp;&nbsp;&nbsp;{{ truename }}
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="{% url 'user_center' %}">Center</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="{% url 'logout' %}">
                <i class="fas fa-power-off"></i>&nbsp;&nbsp;&nbsp;logout
            </a>
        </div>
    </li>
{% endblock %}

{% block currentname %}center{% endblock %}

{% block content %}
<!-- usercenter -->
<div class="agileits-services py-sm-5" id="gallery">
    <div class="container py-lg-5 pt-3 pb-5">
        <div class="w3ls-titles text-center mb-3">
            <h3 class="title">Center</h3>
            <span class="btmspn">
            <i class="fas fa-heartbeat"></i>
        </span>
        </div>
        <div class="w3ls_gallery_grids pt-md-5 pt-3">
            <div class="row agileits_w3layouts_gallery_grid">
                <div class="col-sm-4 mt-">
                    <div class="card card-light col-12" >
                    <img class="card-img-top" src="/media/result/338906827/" alt="Card image" style="width:100%;margin-top:15px">
                    <div class="card-body">
                        <h4 class="card-title">You You </h4>
                        <p class="card-text">Some example text some example text.Some example text some example text.Some example text some example text. </p>
                    </div>
                    </div>
                </div>
                <div class="col-sm-8">
                    <section class="page">
                        <section>
                            <ul class="tabs-controls">
                                <li class="tabs-controls__item">
                                    <a href="#" class="tabs-controls__link tabs-controls__link--active" data-id="1">
                                        个人资料
                                    </a>
                                </li>
                                <li class="tabs-controls__item">
                                    <a href="#" class="tabs-controls__link" data-id="2">
                                        修改资料
                                    </a>
                                </li>
                                <li class="tabs-controls__item">
                                    <a href="#" class="tabs-controls__link" data-id="3">
                                        其他
                                    </a>
                                </li>

                            </ul>
                        </section>
                        <section class="cards-container">
                            <div class="mycard card--current" id="1">
                                <h3>个人信息</h3>
                                <br />
                                <p>
                                    <span>姓名：{{ data.truename }}</span>
                                </p>
                                <br />
                                <p>
                                    {% if "f" in data.gender %}
                                    <span>性别：女</span>
                                    {% else %}
                                    <span>性别：男</span>
                                    {% endif %}
                                </p>
                                <br />
                                <p>
                                    <span>年龄：{{ data.age }}</span>
                                </p>
                                <br />
                                <p>
                                    <span>电话号码：{{ data.phone }}</span>
                                </p>
                                <br />
                                <p>
                                    <span>邮箱：{{ data.email }}</span>
                                </p>
                                <br />
                                <p>
                                    <span>自我介绍：{{ data.details }}</span>
                                </p>
                                <div class="slider-dark">
                                    <a href="#" class="btn tabs-controls__link mytab mt-3 btn-dark" data-id="2">
                                        修改资料
                                    </a>

                                </div>
                            </div>
                            <div class="mycard" id="2">
                                <h3>修改信息<span style="color: red;font-size: 15px;">(注：以下信息留空则不修改该项内容)</span></h3>
                                <form action="{% url 'user_center' %}" method="post">
                                    <br>
                                    <div class="form-group">
                                        <input type="text" name="name" class="form-control" id="name" placeholder="姓名：{{ data.truename }}">
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="age" class="form-control" id="age" placeholder="年龄：{{ data.age }}岁">
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="phone" class="form-control" id="phone" placeholder="手机号：{{ data.phone }}">
                                    </div>
                                    <div class="form-group">
                                        <input type="password" name="password" class="form-control" id="pdw" placeholder="新密码：******">
                                    </div>
                                    <div class="form-group">
                                        <input type="email" name="email" class="form-control" id="email" placeholder="邮箱：{{ data.email }}">
                                    </div>
                                    <div class="form-group">
                                        <input type="text" name="details" class="form-control" id="details" placeholder="详细介绍：{{ data.details }}">
                                    </div>
                                    <button type="submit" class="btn btn-dark">确定修改</button>
                                </form>
                            </div>
                            <div class="mycard" id="3">
                                <h3>其他</h3>
                                <p>

                                </p>
                            </div>
                        </section>
                    </section>
                </div>
            </div>
        </div>
    </div>
</div>

		<!-- //usercenter -->
{% endblock %}

{% block js %}
    <script>
        $(document).ready(function() {
            var oldId = null;

            $('.tabs-controls__link').click(function(e) {
                e.preventDefault();

                if($(this).hasClass('tabs-controls__link--active')) {
                    return false;
                }

                var currentId = parseInt($(this).data('id'), 10);
                $('.tabs-controls__link--active').removeClass('tabs-controls__link--active');
                $(this).addClass('tabs-controls__link--active');

                if(currentId < oldId) { // item is hidden
                    var timing = $('.card.hidden').length * 100;
                    $('.mycard').each(function(index) {
                        if(index > (currentId - 1) || index == (currentId - 1)) {
                            window.setTimeout(function() {
                                $('.mycard').eq(index).removeClass('hidden');
                            }, timing - (index * 100));
                        }
                    });
                } else {
                    $('.mycard').each(function(index) {
                        if(index < (currentId - 1)) {
                            window.setTimeout(function() {
                                $('.mycard').eq(index).addClass('hidden');
                            }, index * 100);
                        }
                    });
                }

                oldId = currentId;
                //开始
                //结束

            });

        });

        /* 有这个js的存在，切换成修改资料的效果就出不来，所以就直接用form提交了
        function Modify() {
            swal({
                    title: "你确定修改吗？",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonClass: "btn-warning",
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "确认",
                    cancelButtonText: "取消",
                    closeOnConfirm: false,
                    showLoaderOnConfirm: true // 显示删除的状态
                },
                function () {
                    // 向后端发送删除的请求
                    $.ajax({
                        url: "{% url 'user_center' %}",
                        type: "POST",
                        data: {
                            "name": $(#name).val(),
                            "age": $(#age).val(),
                            "phone": $(#phone).val(),
                            "pwd": $(#pwd).val(),
                            "email": $(#email).val(),
                            "details": $(#details).val()
                        },
                        success: function(arg) {
                            arg = JSON.parse(arg);
                            console.log("返回了："+arg);
                            if (arg["status"] == 1){
                                alert("成功修改");
                            }
                            else{
                                alert("修改失败");
                            }
                        }
                    });
                    swal("成功", "你已成功修改个人资料", "success");
                });
        }*/
    </script>
{% endblock %}



